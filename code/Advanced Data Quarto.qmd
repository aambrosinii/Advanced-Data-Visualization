---
title: "Advanced Data Visualization"
author: "Alyssa Ambrosini"
date: "5-27-2025"
format: html
editor: visual
Github: "https://github.com/aambrosinii/Advanced-Data-Visualization.git"
---

```{r}
library(tidyverse)
library(here)
library(ggimage)
library(showtext)
library(lubridate)
```

```{r}
# Use Google font
font_add_google("Lato")
showtext_auto()

# Load and prep the data
data <- read_csv(here("data", "envs 193DS data - Sheet1.csv")) %>%
  mutate(
    Date = as.Date(Date),
    WeekType = ifelse(`Week Day (Y/n)` == "Y", "Weekday", "Weekend")
  )
```

```{r}
# Visualization 1: Creation of boxplot for Number of People in Line on Weekdays vs. Weekends

plot1 <- ggplot(data, aes(x = WeekType, y = `Amount of people in line`, fill = WeekType)) +
  geom_boxplot(alpha = 0.7, outlier.color = "black") +
  geom_jitter(width = 0.2, size = 1.5, alpha = 0.6, color = "#654321") +
  scale_fill_manual(values = c("Weekday" = "#A0522D",  # sienna (dark brown)
                               "Weekend" = "#DEB887")) # burlywood (light brown)
  labs(title = "People in Line: Weekdays vs Weekends",
       x = "",
       y = "Number of People") +
  theme_minimal(base_family = "Lato") +
  theme(legend.position = "none")

# Save the plot
png("my_plot.png", width = 800, height = 600)
plot(plot1) 
dev.off()

# Show the plot
print(plot1)
```

```{r}

# Visualization 2: Density plot of duration on weekdays and weekends

# Add font

font_add_google("Lato")
showtext_auto()


# Create the plot
plot2 <- ggplot(data, aes(x = `Duration (s)`, fill = WeekType)) +
  geom_density(alpha = 0.5) +
  
  # Arrow pointing to the tail of weekend distribution
  geom_curve(
    aes(x = 250, y = 0.0055, xend = 300, yend = 0.001),
    arrow = arrow(length = unit(0.03, "npc")),
    curvature = -0.3,
    color = "red",
    size = 0.7,
    inherit.aes = FALSE
  ) +
  
  # Annotation text for the arrow
  annotate(
    "text",
    x = 250, y = 0.0055,
    label = "Long right tail for wait time\non weekends",
    hjust = 0,
    size = 4,
    family = "Lato",
    color = "red"
  ) +
  
  labs(
    title = "Density Distribution of Line Wait Duration on Weekdays and Weekends",
    x = "Duration (seconds)",
    y = "Density"
  ) +
  scale_fill_manual(values = c("steelblue", "darkorange")) +
  theme_minimal(base_family = "Lato") +
  theme(legend.title = element_blank())

# Save the plot
png("my_plot2.png", width = 800, height = 600)
plot(plot2) 
dev.off()
```

```{r}
# Visualization 3: Creating second boxplot showing duration of line wait on weekdays vs. weekends
plot3 <- ggplot(data, aes(x = WeekType, y = `Duration (s)`, fill = WeekType)) +
  geom_boxplot(alpha = 0.7, outlier.color = "black", width = 0.5) +
  labs(
    title = "Observation Duration: Weekdays vs Weekends",
    x = "",
    y = "Duration (seconds)"
  ) +
  theme_minimal(base_family = "Lato") +
  theme(
    legend.position = "none",
    plot.title = element_text(size = 14, face = "bold")
  )

# Save the plot
png("my_plot3.png", width = 800, height = 600)
plot(plot3) 
dev.off()
```
